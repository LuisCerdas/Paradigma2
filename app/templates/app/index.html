{% extends 'app/base.html' %}
{% load static %}

{% block content %}

    <!-- HERO -->
    <section class="hero">
        <h1>Bienvenido a TechHub</h1>
        <p>Descubre la tecnología más reciente y avanzada.</p>
        <a href="#productos" class="hero-btn">Explorar Productos</a>
    </section>

    <!-- CONTENIDO PRINCIPAL -->
    <div class="container">

        <!-- FILTROS -->
        <div id="categorias" class="filters">
            <a href="{% url 'home' %}" class="filter-btn {% if not request.GET.categoria %}active{% endif %}">Todos</a>
            {% for cat in categorias %}
                <a href="?categoria={{ cat }}" class="filter-btn {% if request.GET.categoria == cat %}active{% endif %}">{{ cat }}</a>
            {% endfor %}
        </div>

        <!-- Búsqueda -->
        <div style="margin-bottom: 2rem; text-align: center;">
            <form method="GET" action="{% url 'home' %}" style="display: inline-flex; gap: 0.5rem; max-width: 500px; width: 100%;">
                <input type="text" name="busqueda" placeholder="Buscar productos..." value="{{ request.GET.busqueda }}" style="flex: 1; padding: 0.75rem; border-radius: 8px; border: 1px solid var(--border); background: var(--secondary); color: var(--text);">
                <button type="submit" style="padding: 0.75rem 1.5rem; background: var(--accent); color: white; border: none; border-radius: 8px; cursor: pointer;">
                    <i class="fas fa-search"></i>
                </button>
            </form>
        </div>

        <!-- CATÁLOGO DE PRODUCTOS DINÁMICO -->
        <section id="productos" class="products">

            {% if productos %}
                {% for p in productos %}
                    <div class="product-card">
                        <div class="product-image">
                            <img src="{{ p.imagen_producto|default:'https://via.placeholder.com/300x300?text=Sin+Imagen' }}" 
                                 alt="{{ p.nombre_producto }}" 
                                 class="product-img">
                        </div>

                        <div class="product-info">
                            <div class="product-category">
                                {{ p.categoria_producto|default:"General" }}
                            </div>

                            <div class="product-name">
                                {{ p.nombre_producto }}
                            </div>

                            <div class="product-description">
                                {{ p.descripcion_producto|default:"Sin descripción" }}
                            </div>

                            <div class="product-footer">
                                <div class="product-price">
                                    ₡{{ p.precio_producto }}
                                </div>
                                <form method="POST" action="{% url 'agregar_al_carrito' p.id_producto %}" style="display: inline;">
                                    {% csrf_token %}
                                    <input type="hidden" name="cantidad" value="1">
                                    <button type="submit" class="add-to-cart-btn">
                                        <i class="fas fa-cart-plus"></i> Agregar
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p style="text-align:center; width:100%; font-size:20px; margin-top:20px;">
                    No hay productos registrados.
                </p>
            {% endif %}

        </section>
    </div>
{% endblock %}